<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Simulador Imobili√°rio ‚Äî M√≥dulo Comprador</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Inter',Arial,sans-serif;background:#f5f7fa;color:#222;line-height:1.5;}
header{background:linear-gradient(135deg,#0b6e3b,#0f9b50);color:#fff;text-align:center;padding:28px 18px;position:relative;box-shadow:0 3px 12px rgba(0,0,0,0.08);}
header h1{font-size:24px;font-weight:700;}
header p{opacity:.9;font-size:15px;margin-top:6px;}
#btnLimpar{position:absolute;top:20px;right:20px;background:#fff;color:#0b6e3b;font-weight:600;border:none;border-radius:8px;padding:10px 18px;cursor:pointer;transition:all .2s;}
#btnLimpar:hover{background:#0b6e3b;color:#fff;}
main{max-width:980px;margin:28px auto;background:#fff;padding:26px;border-radius:18px;box-shadow:0 4px 20px rgba(0,0,0,0.05);}
h3.section-title{color:#0b6e3b;margin-bottom:14px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:14px;}
.campo label{font-weight:600;font-size:13px;margin-bottom:6px;display:block;}
.campo input,.campo select{width:100%;padding:10px 12px;border:1px solid #ccc;border-radius:10px;font-size:15px;}
.box{border:1px solid #e6efe9;border-radius:14px;padding:18px;background:#f9fafb;margin-bottom:18px;}
.btn{background:#0b6e3b;color:#fff;border:none;border-radius:10px;padding:12px 24px;cursor:pointer;font-size:16px;font-weight:600;transition:background .2s;}
.btn:hover{background:#0f9b50;}
#diagnosticoContainer{display:none;margin-top:30px;padding:28px;border-radius:16px;background:#e6f3ff;border:1px solid #c6e0f5;}
#diagnosticoContainer h3{color:#064d8a;margin-bottom:14px;}
#diagnosticoConteudo{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px;}
.card-blue{background:#fff;border:1px solid #bcd7f2;border-radius:12px;padding:16px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,0.03);}
.card-blue span{display:block;font-size:13px;color:#555;margin-bottom:6px;}
.card-blue strong{font-size:18px;color:#064d8a;}
</style>
</head>

<body>
<header>
  <h1>Simulador Imobili√°rio ‚Äî Comprador</h1>
  <p>Descubra quanto voc√™ pode financiar com o programa Minha Casa Minha Vida.</p>
  <button id="btnLimpar" onclick="limparTudo()">üßπ Limpar Valores</button>
</header>

<main>
  <!-- CABE√áALHO DO COMPRADOR -->
  <div class="box">
    <h3 class="section-title">üë§ Identifica√ß√£o do(s) Comprador(es)</h3>
    <div class="grid">
      <div class="campo">
        <label>Pretende adquirir sozinho(a) ou com algu√©m?</label>
        <select id="compraCom" onchange="onChangeComposicao()">
          <option value="">Selecione...</option>
          <option value="sozinho">Sozinho(a)</option>
          <option value="namorado">Com namorado(a)</option>
          <option value="noivo">Com noivo(a)</option>
          <option value="conjuge">Com c√¥njuge</option>
          <option value="familiar">Com familiar</option>
        </select>
      </div>

      <div class="campo" id="boxIdade1" style="display:none;">
        <label id="labelIdade1">üéÇ Qual a sua idade?</label>
        <input id="idade1" type="number" min="18" max="99" />
      </div>

      <div class="campo" id="boxRenda1" style="display:none;">
        <label id="labelRenda1">üí∞ Qual a sua renda mensal?</label>
        <input id="renda1" oninput="formatarMoeda(this)" />
      </div>

      <div class="campo" id="boxIdade2" style="display:none;">
        <label>üéÇ Idade do comprador 2</label>
        <input id="idade2" type="number" min="18" max="99" />
      </div>

      <div class="campo" id="boxRenda2" style="display:none;">
        <label>üí∞ Renda mensal do comprador 2</label>
        <input id="renda2" oninput="formatarMoeda(this)" />
      </div>

      <div class="campo" id="boxEstado" style="display:none;">
        <label>üìç Em qual estado ser√° o empreendimento?</label>
        <select id="estado" onchange="onEstadoSelecionado()">
          <option value="">Selecione...</option>
          <option>CE</option><option>SP</option><option>RJ</option><option>MG</option>
          <option>BA</option><option>PE</option><option>PR</option><option>SC</option>
          <option>RS</option><option>GO</option><option>DF</option>
        </select>
      </div>
    </div>
  </div>

  <div class="box" id="boxProf" style="display:none;">
    <h3 class="section-title">üíº Tipo de Renda e Valores p/ Entrada</h3>
    <div class="grid">
      <div class="campo" id="boxSing" style="display:none;">
        <label>Qual o seu regime de trabalho?</label>
        <select id="tipoSing" onchange="onTipoSing()">
          <option value="">Selecione...</option>
          <option value="clt3">Trabalho CLT h√° mais de 3 anos</option>
          <option value="cltmenos">Trabalho CLT h√° menos de 3 anos</option>
          <option value="pj">Sou PJ / Aut√¥nomo</option>
        </select>
      </div>
      <div class="campo" id="boxPlur" style="display:none;">
        <label>Um dos compradores √© CLT h√° mais de 3 anos?</label>
        <select id="tipoPlur" onchange="onTipoPlur()">
          <option value="">Selecione...</option>
          <option value="sim">Sim</option>
          <option value="nao">N√£o</option>
        </select>
      </div>

      <div class="campo" id="boxFgts" style="display:none;">
        <label>üí∞ Possui FGTS e pretende usar?</label>
        <select id="usaFgts" onchange="toggleFgts()">
          <option value="">Selecione...</option>
          <option value="sim">Sim</option>
          <option value="nao">N√£o</option>
        </select>
      </div>

      <div class="campo" id="boxCap" style="display:none;">
        <label>Possui algum valor guardado para entrada?</label>
        <select id="temGuardado" onchange="mostrarDiagnosticoBtn()">
          <option value="">Selecione...</option>
          <option value="sim">Sim</option>
          <option value="nao">N√£o</option>
        </select>
      </div>
    </div>
  </div>

  <div id="boxAcao" style="display:none;text-align:center;">
    <button class="btn" id="btnDiagnostico">Gerar Diagn√≥stico</button>
  </div>

  <!-- DIAGN√ìSTICO AZUL -->
  <div id="diagnosticoContainer">
    <h3>üìò Diagn√≥stico Financeiro</h3>
    <div id="diagnosticoConteudo"></div>
  </div>
</main>

<script>
function formatarMoeda(c){let v=(c.value||"").replace(/\D/g,"");if(!v){c.value="";return;}v=(parseInt(v,10)/100).toFixed(2).replace(".",",");v=v.replace(/\B(?=(\d{3})+(?!\d))/g,".");c.value="R$ "+v;}
function limparMoeda(v){return parseFloat((v||"").replace(/[R$\.\s]/g,"").replace(",", ".")) || 0;}

function onChangeComposicao(){
  const c=compraCom.value;const comp=c!=="sozinho";
  labelIdade1.textContent=comp?"üéÇ Idade do comprador 1":"üéÇ Qual a sua idade?";
  labelRenda1.textContent=comp?"üí∞ Renda mensal do comprador 1":"üí∞ Qual a sua renda mensal?";
  boxIdade1.style.display="block";boxRenda1.style.display="block";
  boxIdade2.style.display=comp?"block":"none";
  boxRenda2.style.display=comp?"block":"none";
  boxEstado.style.display="block";
}
function onEstadoSelecionado(){
  boxProf.style.display="block";
  const solo=compraCom.value==="sozinho";
  boxSing.style.display=solo?"block":"none";
  boxPlur.style.display=solo?"none":"block";
}
function onTipoSing(){
  if(tipoSing.value==="clt3"){boxFgts.style.display="block";}
  else{boxFgts.style.display="none";}
  boxCap.style.display="block";
}
function onTipoPlur(){
  if(tipoPlur.value==="sim"){boxFgts.style.display="block";}
  else{boxFgts.style.display="none";}
  boxCap.style.display="block";
}
function toggleFgts(){/* espa√ßo para integra√ß√£o futura */}

function mostrarDiagnosticoBtn(){boxAcao.style.display="block";}

// Valores fixos das faixas
const tetoFaixa = {"1":190000,"2":264000,"3":350000,"4":500000};

function getTaxaMCMV(renda,cotista,estado){
  const ne=["MA","PI","CE","RN","PB","PE","AL","SE","BA"];
  const regiao=ne.includes(estado)?"no_ne":"sul_se_co";
  let faixa;
  if(renda<=2160)faixa="1";
  else if(renda<=4700)faixa="2";
  else if(renda<=8600)faixa="3";
  else faixa="4";
  const tabela={
    "1":{no_ne:{cot:4.07,nao:4.59},sul_se_co:{cot:4.33,nao:4.85}},
    "2":{no_ne:{cot:6.69,nao:7.23},sul_se_co:{cot:6.69,nao:7.23}},
    "3":{no_ne:{cot:7.93,nao:8.46},sul_se_co:{cot:7.93,nao:8.46}},
    "4":{no_ne:{cot:11.03,nao:11.03},sul_se_co:{cot:11.03,nao:11.03}}
  };
  const taxa=tabela[faixa][regiao][cotista?"cot":"nao"];
  return {faixa,taxa};
}

document.getElementById("btnDiagnostico").addEventListener("click",()=>{
  const renda1v=limparMoeda(renda1.value);
  const renda2v=limparMoeda(renda2.value);
  const estadoV=estado.value;
  const cotista=(compraCom.value==="sozinho"?tipoSing.value==="clt3":tipoPlur.value==="sim");
  const rendaTotal=renda1v+renda2v;
  const {faixa,taxa}=getTaxaMCMV(rendaTotal,cotista,estadoV);
  const valorMax=tetoFaixa[faixa];
  document.getElementById("diagnosticoConteudo").innerHTML=`
    <div class='card-blue'><span>Faixa do MCMV</span><strong>Faixa ${faixa}</strong></div>
    <div class='card-blue'><span>Valor M√°ximo do Im√≥vel a ser Financiado</span><strong>R$ ${valorMax.toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></div>
    <div class='card-blue'><span>Taxa de Juros</span><strong>${taxa.toFixed(2)}% a.a.</strong></div>`;
  document.getElementById("diagnosticoContainer").style.display="block";
});

function limparTudo(){
  document.querySelectorAll("input, select").forEach(el=>el.value="");
  document.querySelectorAll("#boxIdade1,#boxRenda1,#boxIdade2,#boxRenda2,#boxEstado,#boxProf,#boxSing,#boxPlur,#boxFgts,#boxCap,#boxAcao,#diagnosticoContainer")
    .forEach(e=>e.style.display="none");
  document.getElementById("diagnosticoConteudo").innerHTML="";
  window.scrollTo({top:0,behavior:"smooth"});
}
</script>
</body>
</html>
