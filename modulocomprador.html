<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador Imobili√°rio - M√≥dulo Comprador</title>

<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Segoe UI', 'Inter', Arial, sans-serif;
  background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 50%, #10b981 100%);
  min-height: 100vh;
  color: #1e293b;
  line-height: 1.6;
  padding: 20px 0;
}

header {
  background: linear-gradient(135deg, rgba(5, 150, 105, 0.95), rgba(6, 95, 70, 0.95));
  color: #fff;
  text-align: center;
  padding: 40px 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  margin-bottom: 30px;
}

header h1 {
  font-size: clamp(24px, 5vw, 36px);
  font-weight: 700;
  margin-bottom: 10px;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
}

header p {
  font-size: clamp(14px, 3vw, 18px);
  opacity: 0.95;
}

main {
  max-width: 1100px;
  margin: 0 auto;
  background: #ffffff;
  padding: 35px;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
}

.section-title {
  color: #059669;
  margin-bottom: 20px;
  font-size: 20px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 8px;
}

.box {
  border: 2px solid #d1fae5;
  border-radius: 16px;
  padding: 24px;
  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
  margin-bottom: 24px;
  transition: all 0.3s ease;
}

.box:hover {
  box-shadow: 0 8px 20px rgba(5, 150, 105, 0.1);
  transform: translateY(-2px);
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 18px;
}

.campo {
  display: flex;
  flex-direction: column;
}

.campo label {
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 8px;
  color: #065f46;
}

.campo input,
.campo select {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #a7f3d0;
  border-radius: 12px;
  font-size: 15px;
  transition: all 0.3s ease;
  background: #ffffff;
}

.campo input:focus,
.campo select:focus {
  outline: none;
  border-color: #059669;
  box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
}

.btn {
  background: linear-gradient(135deg, #059669, #047857);
  color: #fff;
  border: none;
  border-radius: 12px;
  padding: 14px 28px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
  margin: 8px;
}

.btn:hover {
  background: linear-gradient(135deg, #047857, #065f46);
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(5, 150, 105, 0.4);
}

.btn:active {
  transform: translateY(0);
}

.btn-danger {
  background: linear-gradient(135deg, #dc2626, #b91c1c);
  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
}

.btn-danger:hover {
  background: linear-gradient(135deg, #b91c1c, #991b1b);
  box-shadow: 0 6px 16px rgba(220, 38, 38, 0.4);
}

.btn-large {
  width: 100%;
  max-width: 500px;
  padding: 20px;
  font-size: 18px;
  border-radius: 14px;
  background: linear-gradient(135deg, #059669, #047857);
  color: #fff;
  font-weight: 700;
  cursor: pointer;
  border: none;
  transition: all 0.3s ease;
  box-shadow: 0 8px 20px rgba(5, 150, 105, 0.3);
  margin: 20px auto;
  display: block;
}

.btn-large:hover {
  background: linear-gradient(135deg, #047857, #065f46);
  transform: translateY(-3px);
  box-shadow: 0 12px 28px rgba(5, 150, 105, 0.4);
}

#boxAcao {
  text-align: center;
  margin-top: 30px;
  padding: 20px;
}

#diagnosticoContainer {
  display: none;
  margin-top: 40px;
  padding: 35px;
  border-radius: 20px;
  background: linear-gradient(135deg, #dbeafe, #bfdbfe);
  border: 2px solid #93c5fd;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#diagnosticoContainer h3 {
  color: #1e40af;
  font-size: 22px;
  margin-bottom: 24px;
  text-align: center;
}

#diagnosticoConteudo {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
}

.card-blue {
  background: #ffffff;
  border: 2px solid #93c5fd;
  border-radius: 16px;
  padding: 24px;
  text-align: center;
  box-shadow: 0 4px 12px rgba(30, 64, 175, 0.1);
  transition: all 0.3s ease;
}

.card-blue:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px rgba(30, 64, 175, 0.2);
}

.card-blue span {
  display: block;
  font-size: 13px;
  color: #64748b;
  margin-bottom: 10px;
  font-weight: 500;
}

.card-blue strong {
  font-size: 22px;
  color: #1e40af;
  font-weight: 700;
}

#estimativaContainer {
  display: none;
  margin-top: 40px;
  padding: 35px;
  border-radius: 20px;
  background: linear-gradient(135deg, #fef3c7, #fde68a);
  border: 2px solid #fbbf24;
  animation: fadeIn 0.5s ease;
}

#estimativaContainer h3 {
  color: #92400e;
  font-size: 22px;
  margin-bottom: 24px;
  text-align: center;
}

#boxValorImovel {
  display: none;
  margin-top: 24px;
  padding: 24px;
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.result-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 24px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border-radius: 12px;
  overflow: hidden;
}

.result-table th,
.result-table td {
  border: 1px solid #e5e7eb;
  padding: 14px;
  text-align: center;
}

.result-table th {
  background: linear-gradient(135deg, #059669, #047857);
  color: #ffffff;
  font-weight: 600;
  font-size: 14px;
}

.result-table tr:nth-child(even) {
  background: #f9fafb;
}

.result-table tr:hover {
  background: #f0fdf4;
}

.result-table td strong {
  color: #059669;
  font-size: 16px;
}

#resultadoEntrada {
  margin-top: 24px;
  padding: 24px;
  background: #f0fdf4;
  border-radius: 12px;
  border: 2px solid #a7f3d0;
}

#resultadoEntrada p {
  font-size: 16px;
  margin-bottom: 16px;
  color: #065f46;
}

@media (max-width: 768px) {
  main {
    padding: 20px;
  }

  .grid {
    grid-template-columns: 1fr;
  }

  .btn-large {
    font-size: 16px;
    padding: 16px;
  }

  #diagnosticoConteudo {
    grid-template-columns: 1fr;
  }
}

.info-banner {
  background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
  border-left: 4px solid #0ea5e9;
  padding: 16px;
  border-radius: 8px;
  margin: 20px 0;
  font-size: 14px;
  color: #0c4a6e;
}

.info-banner strong {
  display: block;
  margin-bottom: 8px;
  color: #075985;
}
</style>
</head>

<body>
<header>
  <h1>üè° Simulador Imobili√°rio - M√≥dulo Comprador</h1>
  <p>Descubra quanto voc√™ pode financiar e estime sua entrada com precis√£o</p>
</header>

<main>
  <!-- Identifica√ß√£o -->
  <div class="box">
    <h3 class="section-title">üë§ Identifica√ß√£o do(s) Comprador(es)</h3>
    <div class="grid">
      <div class="campo">
        <label>Pretende adquirir sozinho(a) ou com algu√©m?</label>
        <select id="compraCom" onchange="onChangeComposicao()">
          <option value="">Selecione...</option>
          <option value="sozinho">Sozinho(a)</option>
          <option value="namorado">Com namorado(a)</option>
          <option value="noivo">Com noivo(a)</option>
          <option value="conjuge">Com c√¥njuge</option>
          <option value="familiar">Com familiar</option>
        </select>
      </div>

      <!-- Comprador 1 -->
      <div class="campo" id="boxIdade1" style="display:none;">
        <label id="labelIdade1">üéÇ Qual a sua idade?</label>
        <input id="idade1" type="number" min="18" max="99" placeholder="Digite sua idade" />
      </div>
      <div class="campo" id="boxRenda1" style="display:none;">
        <label id="labelRenda1">üí∞ Qual a sua renda mensal?</label>
        <input id="renda1" oninput="formatarMoeda(this)" placeholder="R$ 0,00" />
      </div>

      <!-- Comprador 2 -->
      <div class="campo" id="boxIdade2" style="display:none;">
        <label>üéÇ Idade do comprador 2</label>
        <input id="idade2" type="number" min="18" max="99" placeholder="Digite a idade" />
      </div>
      <div class="campo" id="boxRenda2" style="display:none;">
        <label>üí∞ Renda mensal do comprador 2</label>
        <input id="renda2" oninput="formatarMoeda(this)" placeholder="R$ 0,00" />
      </div>

      <div class="campo" id="boxEstado" style="display:none;">
        <label>üìç Em qual estado ser√° o empreendimento?</label>
        <select id="estado" onchange="onEstadoSelecionado()">
          <option value="">Selecione...</option>
          <option value="MA">MA - Maranh√£o</option>
          <option value="PI">PI - Piau√≠</option>
          <option value="CE">CE - Cear√°</option>
          <option value="RN">RN - Rio Grande do Norte</option>
          <option value="PB">PB - Para√≠ba</option>
          <option value="PE">PE - Pernambuco</option>
          <option value="AL">AL - Alagoas</option>
          <option value="SE">SE - Sergipe</option>
          <option value="BA">BA - Bahia</option>
          <option value="SP">SP - S√£o Paulo</option>
          <option value="RJ">RJ - Rio de Janeiro</option>
          <option value="MG">MG - Minas Gerais</option>
          <option value="PR">PR - Paran√°</option>
          <option value="SC">SC - Santa Catarina</option>
          <option value="RS">RS - Rio Grande do Sul</option>
          <option value="GO">GO - Goi√°s</option>
          <option value="DF">DF - Distrito Federal</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Tipo de renda -->
  <div class="box" id="boxProf" style="display:none;">
    <h3 class="section-title">üíº Tipo de Renda e Valores para Entrada</h3>
    <div class="grid">
      <div class="campo" id="boxSing" style="display:none;">
        <label>Qual o seu regime de trabalho?</label>
        <select id="tipoSing" onchange="onTipoSing()">
          <option value="">Selecione...</option>
          <option value="clt3">Trabalho CLT h√° mais de 3 anos</option>
          <option value="cltmenos">Trabalho CLT h√° menos de 3 anos</option>
          <option value="pj">Sou PJ / Aut√¥nomo</option>
        </select>
      </div>
      <div class="campo" id="boxFgts" style="display:none;">
        <label>üí∞ Possui FGTS e pretende usar?</label>
        <select id="usaFgts" onchange="toggleFgts()">
          <option value="">Selecione...</option>
          <option value="sim">Sim</option>
          <option value="nao">N√£o</option>
        </select>
      </div>
      <div class="campo" id="boxFgtsVal" style="display:none;">
        <label>üí∞ Valor estimado do FGTS</label>
        <input id="fgtsVal" oninput="formatarMoeda(this)" placeholder="R$ 0,00" />
      </div>
      <div class="campo" id="boxCap" style="display:none;">
        <label>Possui algum valor guardado para entrada?</label>
        <select id="temGuardado" onchange="mostrarValorGuardado()">
          <option value="">Selecione...</option>
          <option value="sim">Sim</option>
          <option value="nao">N√£o</option>
        </select>
      </div>
      <div class="campo" id="boxGuardado" style="display:none;">
        <label>üí∏ Valor guardado</label>
        <input id="valorGuardado" oninput="formatarMoeda(this)" placeholder="R$ 0,00" />
      </div>
    </div>
    
    <div class="info-banner">
      <strong>üí° Dica importante:</strong>
      Para CLT com mais de 3 anos, voc√™ pode usar o FGTS para entrada e reduzir juros (cotista).
    </div>
  </div>

  <div id="boxAcao" style="display:none;">
    <button class="btn" id="btnDiagnostico">üìä Gerar Diagn√≥stico Financeiro</button>
    <button class="btn btn-danger" onclick="limparTudo()">üßπ Limpar Todos os Valores</button>
  </div>

  <!-- Diagn√≥stico -->
  <div id="diagnosticoContainer">
    <h3>üìò Diagn√≥stico Financeiro Completo</h3>
    <div id="diagnosticoConteudo"></div>
  </div>

  <!-- Estimativa -->
  <div id="estimativaContainer">
    <h3>üí∞ Estimativa de Entrada e Financiamento</h3>
    <div style="text-align:center;">
      <button class="btn-large" id="btnAbrirEstimativa">üßÆ Calcular Estimativa Detalhada</button>
    </div>

    <div id="boxValorImovel">
      <div class="grid" style="margin-top:20px;">
        <div class="campo">
          <label>üíé Valor do Im√≥vel (R$)</label>
          <input id="valorImovel" oninput="formatarMoeda(this)" placeholder="R$ 0,00" />
        </div>
      </div>
      <div style="text-align:center;margin-top:20px;">
        <button class="btn" onclick="calcularEntrada()">‚ú® Calcular Cen√°rios</button>
      </div>
      <div id="resultadoEntrada"></div>
    </div>
  </div>
</main>

<script>
// Formata√ß√£o de moeda
function formatarMoeda(input) {
  let valor = (input.value || "").replace(/\D/g, "");
  if (!valor) {
    input.value = "";
    return;
  }
  valor = (parseInt(valor, 10) / 100).toFixed(2).replace(".", ",");
  valor = valor.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  input.value = "R$ " + valor;
}

function limparMoeda(valor) {
  return parseFloat((valor || "").replace(/[R$\.\s]/g, "").replace(",", ".")) || 0;
}

// Controles de interface
function onChangeComposicao() {
  const modo = compraCom.value;
  const emConjunto = modo !== "sozinho" && modo !== "";
  
  if (modo) {
    boxIdade1.style.display = "block";
    boxRenda1.style.display = "block";
    boxEstado.style.display = "block";
    
    if (emConjunto) {
      labelIdade1.textContent = "üéÇ Idade do comprador 1";
      labelRenda1.textContent = "üí∞ Renda mensal do comprador 1";
      boxIdade2.style.display = "block";
      boxRenda2.style.display = "block";
    } else {
      labelIdade1.textContent = "üéÇ Qual a sua idade?";
      labelRenda1.textContent = "üí∞ Qual a sua renda mensal?";
      boxIdade2.style.display = "none";
      boxRenda2.style.display = "none";
    }
  }
}

function onEstadoSelecionado() {
  if (estado.value) {
    boxProf.style.display = "block";
    boxSing.style.display = "block";
  }
}

function onTipoSing() {
  const tipo = tipoSing.value;
  if (tipo === "clt3") {
    boxFgts.style.display = "block";
  } else {
    boxFgts.style.display = "none";
    boxFgtsVal.style.display = "none";
  }
  boxCap.style.display = "block";
}

function toggleFgts() {
  boxFgtsVal.style.display = usaFgts.value === "sim" ? "block" : "none";
}

function mostrarValorGuardado() {
  if (temGuardado.value === "sim") {
    boxGuardado.style.display = "block";
  } else {
    boxGuardado.style.display = "none";
  }
  boxAcao.style.display = "block";
}

// Dados do MCMV
const tetoFaixa = {
  "1": 190000,
  "2": 264000,
  "3": 350000,
  "4": 500000
};

function getTaxaMCMV(renda, cotista, estado) {
  const nordeste = ["MA", "PI", "CE", "RN", "PB", "PE", "AL", "SE", "BA"];
  const regiao = nordeste.includes(estado) ? "no_ne" : "sul_se_co";
  
  let faixa;
  if (renda <= 2160) faixa = "1";
  else if (renda <= 4700) faixa = "2";
  else if (renda <= 8600) faixa = "3";
  else faixa = "4";
  
  const tabela = {
    "1": { no_ne: { cot: 4.07, nao: 4.59 }, sul_se_co: { cot: 4.33, nao: 4.85 } },
    "2": { no_ne: { cot: 6.69, nao: 7.23 }, sul_se_co: { cot: 6.69, nao: 7.23 } },
    "3": { no_ne: { cot: 7.93, nao: 8.46 }, sul_se_co: { cot: 7.93, nao: 8.46 } },
    "4": { no_ne: { cot: 11.03, nao: 11.03 }, sul_se_co: { cot: 11.03, nao: 11.03 } }
  };
  
  const taxa = tabela[faixa][regiao][cotista ? "cot" : "nao"];
  return { faixa, taxa };
}

// Vari√°veis globais
let faixaAtual = null;
let taxaAtual = null;
let rendaAtual = null;

// Gerar diagn√≥stico
document.getElementById("btnDiagnostico").addEventListener("click", () => {
  const r1 = limparMoeda(renda1.value);
  const r2 = limparMoeda(renda2.value);
  const rendaTotal = r1 + r2;
  const estadoV = estado.value;
  const cotista = tipoSing.value === "clt3";
  
  const { faixa, taxa } = getTaxaMCMV(rendaTotal, cotista, estadoV);
  faixaAtual = faixa;
  taxaAtual = taxa;
  rendaAtual = rendaTotal;
  
  const valorMax = tetoFaixa[faixa];
  
  diagnosticoConteudo.innerHTML = `
    <div class='card-blue'>
      <span>Faixa do MCMV</span>
      <strong>Faixa ${faixa}</strong>
    </div>
    <div class='card-blue'>
      <span>Valor M√°ximo Financi√°vel</span>
      <strong>R$ ${valorMax.toLocaleString("pt-BR", { minimumFractionDigits: 2 })}</strong>
    </div>
    <div class='card-blue'>
      <span>Taxa de Juros</span>
      <strong>${taxa.toFixed(2)}% a.a.</strong>
    </div>
    <div class='card-blue'>
      <span>Renda Total</span>
      <strong>R$ ${rendaTotal.toLocaleString("pt-BR", { minimumFractionDigits: 2 })}</strong>
    </div>
  `;
  
  diagnosticoContainer.style.display = "block";
  estimativaContainer.style.display = "block";
  
  // Scroll suave at√© o diagn√≥stico
  diagnosticoContainer.scrollIntoView({ behavior: "smooth", block: "center" });
});

// Abrir estimativa
document.getElementById("btnAbrirEstimativa").addEventListener("click", () => {
  document.getElementById("boxValorImovel").style.display = "block";
  boxValorImovel.scrollIntoView({ behavior: "smooth", block: "center" });
});

// Calcular entrada
function calcularEntrada() {
  const valorImovelVal = limparMoeda(document.getElementById("valorImovel").value);
  
  if (!valorImovelVal) {
    alert("Por favor, informe o valor do im√≥vel!");
    return;
  }
  
  const fgts = limparMoeda(fgtsVal.value);
  const guardado = limparMoeda(valorGuardado.value);
  const entradaTotal = valorImovelVal * 0.2;
  const disponivel = fgts + guardado;
  const faltante = Math.max(0, entradaTotal - disponivel);
  
  // C√°lculo da capacidade de financiamento
  const parcelaMax = rendaAtual * 0.3;
  const i = taxaAtual / 12 / 100;
  const n = 420; // 35 anos
  const vmax = (parcelaMax * (1 - Math.pow(1 + i, -n))) / i;
  const valorFinanciavel = Math.min(vmax, tetoFaixa[faixaAtual]);
  
  const cenarios = [12, 18, 30];
  
  let html = `
    <p><strong>üíé Capacidade estimada de financiamento:</strong> 
    R$ ${valorFinanciavel.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</p>
    <p><strong>üí∞ Entrada necess√°ria (20%):</strong> 
    R$ ${entradaTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</p>
  `;
  
  html += `<table class='result-table'>
    <tr>
      <th>Cen√°rio</th>
      <th>Meses</th>
      <th>Parcela Mensal</th>
      <th>FGTS + Guardado</th>
      <th>Entrada Total</th>
      <th>A Completar</th>
    </tr>`;
  
  cenarios.forEach((meses, index) => {
    const mensal = faltante / meses;
    html += `<tr>
      <td><strong>${index + 1}</strong></td>
      <td>${meses} meses</td>
      <td>R$ ${mensal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</td>
      <td>R$ ${disponivel.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</td>
      <td>R$ ${entradaTotal.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</td>
      <td><strong>R$ ${faltante.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</strong></td>
    </tr>`;
  });
  
  html += "</table>";
  resultadoEntrada.innerHTML = html;
}

// Limpar tudo
function limparTudo() {
  if (!confirm("Deseja realmente limpar todos os valores?")) {
    return;
  }
  
  document.querySelectorAll("input, select").forEach(el => el.value = "");
  document.querySelectorAll("#boxIdade1, #boxIdade2, #boxRenda1, #boxRenda2, #boxEstado, #boxProf, #boxSing, #boxFgts, #boxFgtsVal, #boxCap, #boxGuardado, #boxAcao, #diagnosticoContainer, #estimativaContainer, #boxValorImovel")
    .forEach(e => e.style.display = "none");
  
  diagnosticoConteudo.innerHTML = "";
  resultadoEntrada.innerHTML = "";
  
  window.scrollTo({ top: 0, behavior: "smooth" });
}
</script>
</body>
</html>
