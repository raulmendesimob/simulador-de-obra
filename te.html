<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Simulador ImobiliÃ¡rio SFH/SBPE</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Tahoma,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;color:#1e293b;padding:20px 0}
.hero{background:linear-gradient(135deg,rgba(30,64,175,.95),rgba(99,102,241,.95));padding:40px 20px;text-align:center;box-shadow:0 10px 15px -3px rgba(0,0,0,.1);margin-bottom:30px}
.hero h1{color:#fff;font-size:clamp(24px,5vw,36px);font-weight:700;margin-bottom:12px;text-shadow:2px 2px 4px rgba(0,0,0,.2)}
.hero p{color:rgba(255,255,255,.9);font-size:clamp(14px,3vw,16px);max-width:700px;margin:0 auto;line-height:1.6}
.container{max-width:1100px;margin:0 auto;padding:0 20px}
.form{background:#fff;border-radius:20px;padding:30px;box-shadow:0 10px 15px -3px rgba(0,0,0,.1);margin-bottom:24px}
.grid{display:grid;grid-template-columns:1fr;gap:20px}
@media(min-width:768px){.grid{grid-template-columns:repeat(2,1fr)}.full{grid-column:1/-1}}
.field{display:flex;flex-direction:column}
.field label{font-weight:600;margin-bottom:8px;font-size:14px}
.field input,.field select{width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:15px;transition:.3s;background:#fff}
.field input:focus,.field select:focus{outline:0;border-color:#1e40af;box-shadow:0 0 0 3px rgba(30,64,175,.1)}
.card{background:#fff;border-radius:16px;overflow:hidden;margin-bottom:20px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1)}
.card-header{padding:20px 24px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#1e3a8a,#1e40af);color:#fff;transition:.3s}
.card-header:hover{background:linear-gradient(135deg,#1e40af,#3b82f6)}
.card-header h3{font-size:18px;font-weight:700}
.toggle{background:rgba(255,255,255,.2);width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700}
.card-body{padding:24px;display:none}
.card-body.active{display:block;animation:slide .3s}
@keyframes slide{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.info{padding:16px;border-radius:12px;margin:16px 0;border:2px solid}
.blue{background:#eff6ff;border-color:#93c5fd}
.yellow{background:#fefce8;border-color:#fde047}
.green{background:#f0fdf4;border-color:#86efac}
.divider{height:1px;background:#e2e8f0;margin:24px 0}
.btn{padding:14px 28px;border:0;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;transition:.3s;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);width:100%}
.btn:hover{transform:translateY(-2px);box-shadow:0 10px 15px -3px rgba(0,0,0,.1)}
.btn-primary{background:linear-gradient(135deg,#1e3a8a,#1e40af);color:#fff}
.btn-secondary{background:linear-gradient(135deg,#2563eb,#3b82f6);color:#fff}
.btn-danger{background:linear-gradient(135deg,#dc2626,#ef4444);color:#fff;margin-top:16px}
@media(min-width:768px){.btn{width:auto;min-width:250px;display:block;margin:20px auto 0}}
.result{padding:24px;border-radius:16px;margin:20px 0;display:none;border:2px solid;animation:fade .5s}
@keyframes fade{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.result.show{display:block}
.success{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-color:#22c55e}
.warning{background:linear-gradient(135deg,#fefce8,#fef9c3);border-color:#eab308}
.error{background:linear-gradient(135deg,#fef2f2,#fee2e2);border-color:#ef4444}
.result h3{font-size:20px;margin-bottom:16px}
.result p{margin:10px 0;line-height:1.6}
.alert{color:#dc2626;font-weight:700}
.note{font-size:13px;font-style:italic;color:#64748b;margin-top:12px;line-height:1.5}
.inter-list{display:flex;flex-direction:column;gap:12px;margin-top:16px}
.inter-item{background:#f8fafc;padding:16px;border-radius:12px;border:2px solid #e2e8f0;display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:768px){.inter-item{grid-template-columns:1fr 1fr}}
.small-link{font-size:12px;color:#1e40af;margin-top:8px}
.small-link a{color:#1e40af;text-decoration:underline}
footer{text-align:center;padding:30px 20px;color:#fff;font-size:14px;margin-top:40px}
</style>
</head>
<body>
<div class="hero">
<h1>ğŸ¡ Simulador ImobiliÃ¡rio - SFH/SBPE</h1>
<p>Financiamento contratado <strong>apÃ³s a conclusÃ£o</strong> do empreendimento (PÃ³s-Obra).<br>Calcule sua entrada e gere um relatÃ³rio completo em PDF.</p>
</div>

<div class="container">
<div class="form">
<div class="grid">
<div class="field"><label>ğŸ¢ Empreendimento</label><input id="empreendimento" placeholder="Nome do empreendimento"></div>
<div class="field"><label>ğŸ  Unidade / Bloco / Andar</label><input id="unidade" placeholder="Ex: Apto 101"></div>
<div class="field"><label>ğŸ’° Valor do ImÃ³vel (R$)</label><input id="valorImovel" oninput="fmtM(this)" placeholder="R$ 0,00"></div>
<div class="field"><label>ğŸ¦ Financiamento (R$)</label><input id="valorFinanciamento" oninput="fmtM(this)" placeholder="R$ 0,00"></div>
<div class="field"><label>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Renda Familiar (R$)</label><input id="renda" oninput="fmtM(this)" placeholder="R$ 0,00"></div>
<div class="field full"><label>ğŸ“… PrevisÃ£o de Entrega</label><select id="entregaSelect"></select></div>
</div>
</div>

<div class="card">
<div class="card-header" onclick="toggle(this)"><h3>ğŸ’° Entrada / Fluxo Inicial</h3><span class="toggle">+</span></div>
<div class="card-body">
<div class="grid">
<div class="field"><label>ğŸ’¸ Valor do Ato (R$)</label><input id="ato" oninput="fmtM(this)" placeholder="R$ 0,00"></div>
<div class="field"><label>ğŸ—“ï¸ Meses / Parcelas</label><input id="parcelasEntrada" type="number" min="1" placeholder="12"></div>
</div>
<div class="divider"></div>
<div class="info blue">
<div class="field full"><label>ğŸ“Œ Tem IntermediÃ¡rias/Anuais/ReforÃ§os?</label><select id="temInter" onchange="togInter()"><option value="nao">NÃ£o</option><option value="sim">Sim</option></select></div>
<div class="field full" id="boxQ" style="display:none;margin-top:16px"><label>Quantidade</label><input id="qtdInter" type="number" min="1" max="12" value="1" onchange="renderI()"></div>
<div id="boxR" style="display:none"><div class="inter-list" id="iList"></div></div>
</div>
<div class="divider"></div>
<div class="info yellow">
<div class="field"><label>ğŸ—ï¸ Aceita Saldo PÃ³s-Chaves?</label><select id="aceitaPos"><option value="nao">NÃ£o</option><option value="sim">Sim</option></select></div>
</div>
<button class="btn btn-primary" onclick="calc()">Calcular Entrada</button>
</div>
</div>

<div id="res" class="result"></div>

<div class="card">
<div class="card-header" onclick="toggle(this)"><h3>ğŸ“„ Gerar PDF</h3><span class="toggle">+</span></div>
<div class="card-body">
<div class="grid">
<div class="field"><label>ğŸ‘¤ Cliente</label><input id="pdfCliente"></div>
<div class="field"><label>ğŸ“ Tel Cliente</label><input id="pdfClienteFone" oninput="fmtT(this)"></div>
<div class="field"><label>ğŸ§‘â€ğŸ’¼ Corretor</label><input id="pdfCorretor"></div>
<div class="field"><label>ğŸ“ Tel Corretor</label><input id="pdfCorretorFone" oninput="fmtT(this)"></div>
</div>
<div class="divider"></div>
<div class="info green">
<div class="grid">
<div class="field"><label>ğŸ“ˆ Incluir INCC?</label><select id="inccInc" onchange="togINCC()"><option value="nao">NÃ£o</option><option value="sim">Sim</option></select></div>
<div class="field" id="boxT" style="display:none"><label>ğŸ“Œ INCC % mensal</label><input id="inccTaxa" value="0,5"><div class="small-link">ğŸ“Š <a href="https://portal.fgv.br/noticias/incc-m-2025" target="_blank">portal.fgv.br</a></div></div>
</div>
<div class="divider" id="divS" style="display:none"></div>
<div class="grid" id="boxS" style="display:none">
<div class="field"><label>INCC na Entrada?</label><select id="inccE"><option value="nao">NÃ£o</option><option value="sim">Sim</option></select></div>
<div class="field"><label>INCC no Saldo?</label><select id="inccS"><option value="nao">NÃ£o</option><option value="sim">Sim</option></select></div>
<div class="field full"><div class="note">* O INCC Ã© estimativa mÃ©dia e pode variar.</div></div>
</div>
</div>
<button class="btn btn-secondary" onclick="pdf()">ğŸ“¥ Gerar PDF</button>
</div>
</div>
</div>

<footer>
<p>Simulador ImobiliÃ¡rio â€¢ Uso educativo â€¢ Valores estimados</p>
<p>Desenvolvido com â¤ï¸ para simulaÃ§Ãµes imobiliÃ¡rias</p>
</footer>

<script>
function fmtM(i){let v=(i.value||"").replace(/\D/g,"");if(!v){i.value="";return}v=(parseInt(v,10)/100).toFixed(2).replace(".",",");v=v.replace(/\B(?=(\d{3})+(?!\d))/g,".");i.value="R$ "+v}
function limM(v){return parseFloat((v||"").replace(/[R$\.\s]/g,"").replace(",","."))||0}
function m(n){return n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}
function fmtT(i){let v=(i.value||"").replace(/\D/g,"").slice(0,11);if(v.length<=2){i.value=v;return}const d=v.slice(0,2),r=v.slice(2);if(r.length<=4){i.value=`(${d}) ${r}`;return}if(r.length<=8){i.value=`(${d}) ${r.slice(0,4)}-${r.slice(4)}`;return}i.value=`(${d}) ${r.slice(0,5)}-${r.slice(5)}`}
function pRate(){const r=(document.getElementById("inccTaxa").value||"0").trim().replace("%","").replace(/\s+/g,"").replace(",",".");const p=parseFloat(r);if(!isFinite(p)||p<0)return 0;return p/100}
function gMeses(){const h=new Date(),a=[],n=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];for(let i=0;i<48;i++){const d=new Date(h.getFullYear(),h.getMonth()+i,1);a.push(`${n[d.getMonth()]}/${String(d.getFullYear()).slice(-2)}`)}return a}
(function(){const s=document.getElementById("entregaSelect");gMeses().forEach(t=>{const o=document.createElement("option");o.textContent=t;s.appendChild(o)})})();
function toggle(h){const b=h.nextElementSibling,i=h.querySelector(".toggle"),a=b.classList.contains("active");b.classList.toggle("active");i.textContent=a?"+":"âˆ’"}
function togINCC(){const inc=document.getElementById("inccInc").value==="sim";document.getElementById("boxT").style.display=inc?"block":"none";document.getElementById("divS").style.display=inc?"block":"none";document.getElementById("boxS").style.display=inc?"grid":"none";if(!inc){document.getElementById("inccTaxa").value="0,5";document.getElementById("inccE").value="nao";document.getElementById("inccS").value="nao"}}
function togInter(){const t=document.getElementById("temInter").value,s=t==="sim";document.getElementById("boxQ").style.display=s?"block":"none";document.getElementById("boxR").style.display=s?"block":"none";if(s)renderI();else{document.getElementById("iList").innerHTML="";document.getElementById("qtdInter").value=1}}
function renderI(){const q=parseInt(document.getElementById("qtdInter").value,10)||0,l=document.getElementById("iList");l.innerHTML="";if(q<=0)return;const ms=gMeses();for(let i=1;i<=q;i++){const d=document.createElement("div");d.className="inter-item";d.innerHTML=`<div class="field"><label>${i}Âº pagamento</label><select>${ms.map(mm=>`<option>${mm}</option>`).join("")}</select></div><div class="field"><label>Valor (R$) *</label><input oninput="fmtM(this)"></div>`;l.appendChild(d)}}
function setRes(t,h){const r=document.getElementById("res");r.className=`result ${t} show`;r.innerHTML=h}
function calc(){const vi=limM(document.getElementById("valorImovel").value),vf=limM(document.getElementById("valorFinanciamento").value),at=limM(document.getElementById("ato").value),re=limM(document.getElementById("renda").value),p=parseInt(document.getElementById("parcelasEntrada").value,10)||0;if(!vi||!vf||!re||!p){setRes("error",`<h3>âš ï¸ Dados Incompletos</h3><p class="alert">Preencha: Valor do ImÃ³vel, Financiamento, Renda e Parcelas.</p><button class="btn btn-danger" onclick="limpar()">Limpar</button>`);return}const ve=vi-vf,tem=document.getElementById("temInter").value==="sim";const iV=[],iM=[];if(tem){const rs=document.querySelectorAll("#iList .inter-item");if(!rs.length){setRes("error",`<h3>âš ï¸ Pagamentos Extras</h3><p class="alert">Marcou extras mas nÃ£o informou quantidade.</p><button class="btn btn-danger" onclick="limpar()">Limpar</button>`);return}let f=false;rs.forEach(r=>{const s=r.querySelector("select"),inp=r.querySelector("input"),d=s?s.value:"-",mA=s?s.selectedIndex:0,v=limM(inp?inp.value:"");if(!v||v<=0)f=true;iV.push(v);iM.push({data:d,mesesAte:mA,valorBase:v})});if(f){setRes("error",`<h3>âš ï¸ Valores ObrigatÃ³rios</h3><p class="alert">Preencha valor de todos pagamentos extras.</p><button class="btn btn-danger" onclick="limpar()">Limpar</button>`);return}}const sI=iV.reduce((a,b)=>a+b,0);let sl=ve-at-sI;const eT=document.getElementById("entregaSelect").value;if(sl<=0){window.__calc={entradaTotal:ve,ato:at,parcelas:p,mensal:0,interVals:iV,interMeta:iM,saldoRestante:0,status:"success"};const iH=tem&&sI>0?`<p>ğŸ’µ Extras: <strong>${m(sI)}</strong></p>`:"";setRes("success",`<h3>âœ… Fluxo Calculado</h3><p>ğŸ“… Entrega: <strong>${eT}</strong></p><p>ğŸ’° Entrada: ${m(ve)}</p><div class="divider"></div><p>ğŸ’¸ Ato: <stron
